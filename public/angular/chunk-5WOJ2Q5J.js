import{a as A}from"./chunk-A2E7EA2J.js";import{a as I,b as w,c as M}from"./chunk-H6N6TYSD.js";import{e as y,k as S}from"./chunk-4AVR65JZ.js";import"./chunk-XAZLOLJU.js";import{A as u,K as C,Ka as a,Ma as n,Oa as d,Ra as c,Sa as m,Ta as l,Ua as g,Va as T,Wa as s,X as P,Ya as x,ab as b,da as v,ea as h,n as _,xa as p,y as f,ya as r}from"./chunk-QATPKBQI.js";function V(o,e){if(o&1&&l(0,"app-post",0),o&2){let t=s(2);n("post",t.post.ParentPost)}}function j(o,e){if(o&1){let t=g();c(0,"app-textarea",4),T("sendText",function(D){v(t);let E=s(2);return h(E.add(D))}),m()}if(o&2){let t=s(2);n("setText",t.textareaContent)}}function N(o,e){o&1&&(c(0,"p",2),x(1,"Login to post"),m())}function R(o,e){if(o&1&&(a(0,V,1,1,"app-post",0),l(1,"app-post",0),a(2,j,1,1,"app-textarea",1)(3,N,2,0,"p",2),l(4,"app-postlist",3)),o&2){let t=s();d(t.post.ParentPost?0:-1),p(),n("post",t.post),p(),d(t._authservice.userdata()?2:3),p(2),n("list",t.post.ChildPosts)}}function z(o,e){o&1&&(c(0,"p"),x(1,"This post doesn't exist."),m())}var O=class o{constructor(e,t,i){this.route=e;this._postservice=t;this._authservice=i}post;textareaContent="";ngOnInit(){this.getPost()}getPost(){this.route.paramMap.pipe(C(e=>this._postservice.getUserPostById(e.get("username"),e.get("id")).pipe(f(t=>_(t))))).subscribe({next:e=>{this.post=e},error:e=>{console.log(e)}})}add(e){let t=this._authservice.userdata()?.id??0;this._postservice.addNewPost({content:e,id:t,parentpostid:this.post.id}).pipe(u(1e3)).subscribe({next:i=>{this.getPost()},error:i=>{alert(i.error)}})}static \u0275fac=function(t){return new(t||o)(r(y),r(M),r(S))};static \u0275cmp=P({type:o,selectors:[["app-postexpanded"]],standalone:!0,features:[b],decls:2,vars:1,consts:[[3,"post"],[3,"setText"],[1,"text-area-p"],[3,"list"],[3,"sendText","setText"]],template:function(t,i){t&1&&a(0,R,5,4)(1,z,2,0,"p"),t&2&&d(i.post?0:1)},dependencies:[w,I,A],styles:["textarea[_ngcontent-%COMP%]{margin:8px 0;width:100%;font-size:16px;padding:8px;border-radius:2px;font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif;resize:none}"]})};export{O as PostexpandedComponent};
