import{a as R}from"./chunk-BVGIIEUE.js";import{a as I,b as E,c as V}from"./chunk-QEPDTPTK.js";import{e as b,g as w,k as A}from"./chunk-JOLVZ6UO.js";import{A as u,La as l,Na as c,Pa as m,Sa as n,Ta as a,Ua as _,Va as h,Wa as P,X as f,Xa as r,Ya as y,Za as T,_a as g,ab as x,da as C,ea as v,eb as S,ya as p,za as d}from"./chunk-7YK7SVYE.js";var D=["emptydiv"];function M(t,i){if(t&1&&_(0,"app-postlist",2),t&2){let e=r(3);c("list",e.post.ParentPosts)("showSeperator",!0)}}function Q(t,i){if(t&1){let e=h();n(0,"app-textarea",7),P("sendText",function(s){C(e);let j=r(3);return v(j.add(s))}),a()}if(t&2){let e=r(3);c("clearTextArea",e.clearTextArea)}}function N(t,i){t&1&&(n(0,"p",5),x(1,"Login to post"),a())}function U(t,i){if(t&1&&(n(0,"div",1),l(1,M,1,2,"app-postlist",2),_(2,"app-post",3),n(3,"div",null,0),x(5,"\xA0"),a(),l(6,Q,1,1,"app-textarea",4)(7,N,2,0,"p",5),_(8,"app-postlist",6),a()),t&2){let e=r(2);p(),m(e.post.ParentPosts?1:-1),p(),c("post",e.post),p(4),m(e._authservice.userdata()?6:7),p(2),c("list",e.post.ChildPosts)}}function k(t,i){t&1&&(n(0,"p"),x(1,"Post doesn't exist"),a())}function z(t,i){if(t&1&&l(0,U,9,4,"div",1)(1,k,2,0,"p"),t&2){let e=r();m(e.post?0:1)}}function F(t,i){t&1&&x(0,` loading...
`)}var O=class t{constructor(i,e,o,s){this.route=i;this._postservice=e;this._authservice=o;this.router=s}post;clearTextArea=0;emptydiv;data;dataloading=!0;ngOnInit(){this.route.params.pipe().subscribe({next:i=>{this.data={username:i.username,id:i.id},this.getPost()}})}getPost(){this.dataloading=!0,this._postservice.getUserPostById(this.data.username,this.data.id).subscribe({next:i=>{this.post=i,setTimeout(()=>this.emptydiv.nativeElement.scrollIntoView({behavior:"smooth"}),600),this.dataloading=!1},error:i=>{console.log(i)}})}add(i){let e=this._authservice.userdata()?.id??0;e!=0&&this._postservice.addNewPost({content:i.content,id:e,parentpostid:this.post.id,file:i.file}).pipe(u(1e3)).subscribe({next:o=>{this.getPost(),this.clearTextArea++},error:o=>{alert(o.error)}})}static \u0275fac=function(e){return new(e||t)(d(b),d(V),d(A),d(w))};static \u0275cmp=f({type:t,selectors:[["app-postexpanded"]],viewQuery:function(e,o){if(e&1&&y(D,5),e&2){let s;T(s=g())&&(o.emptydiv=s.first)}},standalone:!0,features:[S],decls:2,vars:1,consts:[["emptydiv",""],[1,"container"],[3,"list","showSeperator"],[3,"post"],["placeholderText","Post your reply",3,"clearTextArea"],[1,"text-area-p"],[3,"list"],["placeholderText","Post your reply",3,"sendText","clearTextArea"]],template:function(e,o){e&1&&l(0,z,2,1)(1,F,1,0),e&2&&m(o.dataloading?1:0)},dependencies:[E,I,R],styles:["textarea[_ngcontent-%COMP%]{margin:8px 0;width:100%;font-size:16px;padding:8px;border-radius:2px;font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif;resize:none}"]})};export{O as PostexpandedComponent};
